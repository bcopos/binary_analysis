// Protocol depicting diagram
// Bogdan Copos

digraph hw {

size = "5,4";
ratio = "1";

overlap = false;
rankdir = "LR";
ratio = "compress";

node [shape = folder, fixedsize = true, width = 2, label="Input Strings DB"] inputdb;
node [shape = box, fixedsize = true, width = 2, label="PIN tool"] pintool;
node [shape = box, fixedsize = true, width = 2, label="Binary"] binary;
node [shape = box, fixedsize = true, width = 2, label="Argument Finder"] argfinder;
node [shape = folder, fixedsize = true, width = 2, label="Permutations"] permutations;
node [shape = box, fixedsize = true, width = 2, label="Instrumented Binary"] instrbin;
node [shape = note, fixedsize = true, width = 2, label="Trace"] trace;
node [shape = note, fixedsize = true, width = 2, label="Trace CMD1"] trace1;
node [shape = note, fixedsize = true, width = 2, label="Trace CMD2"] trace2;
node [shape = box, fixedsize = true, width = 2, label="Protocol Identifier"] pi;

permutations -> argfinder;
argfinder -> binary [label="use input finding technique to find valid args"];
binary -> argfinder;
argfinder -> inputdb [label="record argument for input string"];

binary -> pintool [label="instrument binary to record excecution trace"];
pintool -> instrbin;

inputdb -> instrbin;
instrbin -> trace;
trace -> trace1;
trace -> trace2;

trace1 -> pi;
trace2 -> pi;

}

